version: "3.2"

services:
  conan:
    container_name: conan
    build: .
    restart: "unless-stopped"
    network_mode: host
    volumes:
      - conan_data:/home/steam/conan-dedicated
    env_file:
      - .env
    environment:
      - PUID=1000
      - PGID=1000
      - WINEARCH=win64
      - WINEARCHPREFIX=/home/steam/.wine64
      - CONAN_ARGS=-log -PublicIP=${PUBLIC_IP} -ServerName="${SERVER_NAME:-Conan Exiles Server}" -MaxPlayers=${MAX_PLAYERS:-10} -ServerPassword="${SERVER_PASSWORD:-}" -AdminPassword="${ADMIN_PASSWORD:-}" -Port=${GAME_PORT:-7777} -QueryPort=${QUERY_PORT:-27015} -RconEnabled=${RCON_ENABLED:-False} -RconPassword="${RCON_PASSWORD:-}" -RconPort=${RCON_PORT:-25575} -RconMaxKarma=${RCON_MAX_KARMA:-60} ${PVP_ENABLED:-true} -ServerRegion=${SERVER_REGION:-0} -ServerCommunity=${SERVER_COMMUNITY:-0} -ItemConvertionMultiplier=${ITEM_CONVERSION_MULTIPLIER:-1.0} -PlayerXPRateMultiplier=${PLAYER_XP_RATE:-1.0} -PlayerXPKillMultiplier=${PLAYER_XP_KILL:-1.0} -PlayerXPCraftMultiplier=${PLAYER_XP_CRAFT:-1.0} -PlayerXPTimeMultiplier=${PLAYER_XP_TIME:-1.0} -ThrallConversionMultiplier=${THRALL_CONVERSION:-1.0} -ThrallCraftingTimeMultiplier=${THRALL_CRAFTING_TIME:-1.0} -ThrallWakeUpTimeMultiplier=${THRALL_WAKEUP_TIME:-1.0} -FuelBurnTimeMultiplier=${FUEL_BURN_TIME:-1.0} -CraftingTimeMultiplier=${CRAFTING_TIME:-1.0} -CraftingCostMultiplier=${CRAFTING_COST:-1.0} -PlayerDamageMultiplier=${PLAYER_DAMAGE:-1.0} -PlayerDamageTakenMultiplier=${PLAYER_DAMAGE_TAKEN:-1.0} -MinionDamageMultiplier=${MINION_DAMAGE:-1.0} -MinionDamageTakenMultiplier=${MINION_DAMAGE_TAKEN:-1.0} -NPCDamageMultiplier=${NPC_DAMAGE:-1.0} -NPCDamageTakenMultiplier=${NPC_DAMAGE_TAKEN:-1.0} -StructureDamageMultiplier=${STRUCTURE_DAMAGE:-1.0} -StructureDamageTakenMultiplier=${STRUCTURE_DAMAGE_TAKEN:-1.0} -ResourceRespawnSpeedMultiplier=${RESOURCE_RESPAWN:-1.0} -StaminaCostMultiplier=${STAMINA_COST:-1.0} -ActiveEventMultiplier=${ACTIVE_EVENT:-1.0} -StormGlassRespawnTime=${STORM_GLASS_RESPAWN:-1.0} -DropEquipmentOnDeath=${DROP_EQUIPMENT:-true} -EverybodyCanLootCorpse=${EVERYBODY_LOOT_CORPSE:-false} -LogoutCharactersRemainInTheWorld=${LOGOUT_CHARACTERS_REMAIN:-true} -TeleportVulnerabilityTime=${TELEPORT_VULNERABILITY:-10} -ShowPlayerLocationInfo=${SHOW_PLAYER_LOCATION:-false} -EnableSandStorm=${ENABLE_SANDSTORM:-true} -canseeplayernames=${CAN_SEE_PLAYER_NAMES:-true} -chatHasServerFilter=${CHAT_SERVER_FILTER:-true} -chatHasGlobalVoiceChat=${CHAT_GLOBAL_VOICE:-true} -chatHasLocalVoiceChat=${CHAT_LOCAL_VOICE:-true} -MaxNudity=${MAX_NUDITY:-2} -ServerVoiceChat=${SERVER_VOICE_CHAT:-true} -AvatarsDisabled=${AVATARS_DISABLED:-false} -HarvestAmountMultiplier=${HARVEST_AMOUNT:-1.0} -DamageMultiplier=${DAMAGE_MULTIPLIER:-1.0} -DamageTakenMultiplier=${DAMAGE_TAKEN_MULTIPLIER:-1.0} -HungerMultiplier=${HUNGER_MULTIPLIER:-1.0} -ThirstMultiplier=${THIRST_MULTIPLIER:-1.0} -UnconsciousTimeSeconds=${UNCONSCIOUS_TIME:-30} -ConciousnessDamageMultiplier=${CONSCIOUSNESS_DAMAGE:-1.0} -ValidatePhysXVisualDebuggerConnection=${VALIDATE_PHYSX:-false} -BattlEyeEnabled=${BATTLEYE_ENABLED:-true} -RegionBlockList="${REGION_BLOCK_LIST:-}" -ServerModList="${SERVER_MOD_LIST:-}" -MultiHome="${MULTI_HOME:-0.0.0.0}" -UseBattlEye=${USE_BATTLEYE:-true}
    ports:
      - 7777:7777/udp
      - 7778:7778/udp
      - 27015:27015/udp

volumes:
  conan_data:
